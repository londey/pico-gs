# REQ-006.01: Display Output

## Classification

- **Priority:** Important
- **Stability:** Stable
- **Verification:** Demonstration

## Requirement

When the GPU has completed rasterizing a frame and the display controller is active, the system SHALL output a 640×480 progressive video signal via DVI/HDMI at approximately 60 Hz using TMDS encoding, such that the rendered image is visible on a standard monitor without rolling, tearing, or flicker.

## Rationale

The primary purpose of the GPU is to produce visible output on a standard consumer display.
DVI TMDS encoding over differential pairs allows use of commodity HDMI monitors without a dedicated DAC.
Display refresh must be unconditionally stable regardless of rendering load so the user never sees a blank or locked display.

## Parent Requirements

- REQ-006 (Screen Scan Out)

## Allocated To

- UNIT-008 (Display Controller)
- UNIT-009 (DVI TMDS Encoder)

## Interfaces

- INT-002 (DVI TMDS Output)
- INT-010 (GPU Register Map)
- INT-011 (SDRAM Memory Layout)

## Verification Method

**Demonstration:** The system SHALL meet the following acceptance criteria:

- [ ] 640×480 @ 60Hz resolution via DVI/HDMI
- [ ] TMDS encoding using ECP5 SERDES blocks
- [ ] Stable sync signals (no rolling, tearing, or flicker)
- [ ] Display refresh never stalls regardless of draw load
- [ ] Color grading LUT applies correctly at scanout when enabled
- [ ] LUT updates complete within one frame without tearing

---


## Notes

**SDRAM Burst Read Impact:**
Display scanout is the highest-priority SDRAM consumer (INT-011).
UNIT-008 uses burst reads for scanline prefetch.
The source framebuffer width is `1 << FB_DISPLAY.FB_WIDTH_LOG2` pixels per scanline (INT-010); the display controller fetches exactly that many pixels from SDRAM per source row.
With the 4×4 block-tiled framebuffer layout (INT-011), pixels within a tile occupy sequential column addresses within the same SDRAM row, so each 4×4 tile can be fetched with a single row activation followed by a burst of tile-width column accesses.
After fetching a source scanline, the display controller applies a Bresenham nearest-neighbor horizontal scaler (UNIT-008) to expand the source pixels to the 640-pixel DVI output width.
When FB_DISPLAY.LINE_DOUBLE is set, each source scanline is output twice, halving the required SDRAM scanout bandwidth (UNIT-008).
The display controller de-tiles blocks into scanline order as it feeds the scanline FIFO.
This reduces per-word overhead and frees SDRAM bandwidth for lower-priority rendering operations (framebuffer writes, Z-buffer access, texture fetches).
Display refresh stability under heavy draw load is maintained because burst tile reads amortize the SDRAM row activation and CAS latency costs across multiple pixels per burst.
