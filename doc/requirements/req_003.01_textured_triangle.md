# REQ-003.01: Textured Triangle

## Classification

- **Priority:** Important
- **Stability:** Stable
- **Verification:** Test

## Requirement

When the firmware writes three VERTEX registers with RENDER_MODE configured for texture mapping, the system SHALL rasterize a triangle with UV coordinates interpolated across the surface and sample texture data at each pixel using the configured texture unit.

## Rationale

Texture mapping is essential for realistic rendering, allowing surface detail without increasing geometric complexity. It enables: realistic materials (wood, metal, stone), decals and labels, sprite rendering for UI, and efficient detail representation (one 256×256 texture = 65,536 triangles of flat-shaded detail).

## Parent Requirements

REQ-003

## Allocated To

- UNIT-005 (Rasterizer)
- UNIT-006 (Pixel Pipeline)

## Interfaces

- INT-010 (GPU Register Map)
- INT-011 (SDRAM Memory Layout)
- INT-014 (Texture Memory Layout)

## Verification Method

**Test:** Two planned VER documents together will provide Test-level coverage for this requirement (VER files not yet created; see `doc/verification/README.md`):

- **VER-005** (texture_decoder_tb) — Verilator unit test for the texture decoder module.
  Drives the decoder with known SDRAM-format tile data and verifies that decoded RGBA5652 output matches expected pixel values.
  Covers all supported texture formats, wrap/clamp modes, and perspective-correct UV interpolation inputs.
- **VER-012** (textured triangle golden image) — Pipeline integration test that renders a textured triangle through the full RTL hierarchy under Verilator, using a behavioral SDRAM model populated with a known test texture.
  The rendered framebuffer is compared pixel-exactly against the approved golden image at `spi_gpu/tests/golden/textured_triangle.ppm`.

Acceptance criteria (to be verified jointly by VER-005 and VER-012):

- TEXn_CFG.ENABLE, FORMAT, BASE_ADDR, WIDTH_LOG2, HEIGHT_LOG2 configure the texture unit correctly.
- UV coordinates (U/W, V/W, 1/W) are perspective-correct; no affine warping is visible.
- Texture coordinates wrap or clamp per TEXn_CFG.U_WRAP / V_WRAP.
- Final pixel equals texture color × vertex color (MODULATE combiner mode).

---


## Notes

Texture mapping requires both geometric data (vertices) and UV coordinates.
The GPU supports up to 2 simultaneous texture units (REQ-003.02) with a programmable color combiner (REQ-004.01).
