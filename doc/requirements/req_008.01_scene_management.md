# REQ-008.01: Scene Management

## Classification

- **Priority:** Essential
- **Stability:** Stable
- **Verification:** Test

## Requirement

When a user input event selects a new demonstration scene, the system SHALL update the active demo state, execute any required one-time initialization for that demo (such as texture uploads or state resets), and then generate per-frame render commands appropriate to the newly active demo.

When the active demo requires one-time initialization, the system SHALL complete that initialization before rendering the first frame of the new demo.

## Rationale

A centralized scene manager decouples the demo selection logic and per-demo initialization from the render pipeline, allowing new demos to be added without modifying the core rendering or input systems.

## Parent Requirements

REQ-008 (Scene Graph/ECS)

## Allocated To

- UNIT-020 (Core 0 Scene Manager)
- UNIT-027 (Demo State Machine)
- UNIT-021 (Core 1 Render Executor)
- UNIT-022 (GPU Driver Layer)

## Interfaces

- INT-021 (Render Command Format)
- INT-020 (GPU Driver API)

## Verification Method

**Test:** Verify that switching demos updates the active demo state, triggers one-time initialization on first frame, and generates the correct sequence of render commands (clear, set mode, submit triangles, vsync) for each demo type.

## Notes

The scene graph tracks an active demo enum (GouraudTriangle, TexturedTriangle, SpinningTeapot) and a `needs_init` flag. Demo-specific mesh data is pre-built at compile time via the asset pipeline (const flash data). Per-frame rendering for SpinningTeapot consists of frustum culling patch AABBs and enqueuing RenderMeshPatch commands; vertex transformation and lighting are performed by Core 1. The default demo on boot is GouraudTriangle.

On the PC platform, scene management runs in a single thread (no Core 0/Core 1 distinction).
The scene management logic itself is platform-agnostic and shared between platforms.
