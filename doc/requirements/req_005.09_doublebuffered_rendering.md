# REQ-005.09: Double-Buffered Rendering

## Classification

- **Priority:** Essential
- **Stability:** Stable
- **Verification:** Test

## Requirement

When the host submits a completed frame, the system SHALL swap the front and back framebuffer pointers in the GPU register map (INT-010) such that the display controller begins scanning out the newly rendered buffer on the next vsync boundary, while the previously displayed buffer becomes the new back-buffer available for rendering.

## Rationale

Double buffering eliminates tearing by ensuring the display always reads from a completed frame while the host writes into a separate buffer.
Swapping on a vsync boundary guarantees the transition occurs during the blanking interval, preventing a partially-updated frame from being displayed.

## Parent Requirements

- REQ-005 (Blend/Frame Buffer Store)

## Allocated To

- UNIT-022 (GPU Driver Layer)
- UNIT-008 (Display Controller)
- UNIT-021 (Core 1 Render Executor)

## Interfaces

- INT-010 (GPU Register Map)
- INT-011 (SDRAM Memory Layout)
- INT-020 (GPU Driver API)

## Verification Method

**Test:** Render two distinct frames to alternating back-buffers.
After each swap command, verify that the display base address register in INT-010 points to the buffer that was most recently completed.
Verify that the previous front-buffer address is now the active back-buffer address.
Verify that swaps occur on vsync boundaries by observing that no swap takes effect mid-scan.

## Notes

The two framebuffer regions are defined in INT-011 (SDRAM Memory Layout).
The framebuffer swap involves updating FB_DISPLAY.FB_ADDR and FB_DISPLAY.FB_WIDTH_LOG2 to point to the completed buffer; FB_CONFIG.COLOR_BASE is updated to the new back-buffer address for subsequent rendering.
